{
  "hash": "ef28fcc8832713b4f4a8b6c8804506ba",
  "result": {
    "markdown": "---\ntitle: \"In-class Exercise 06b: Network Visualisation\"\nauthor: \"Ten Wei Peng\"\ndate: \"May 18, 2024\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n\n## Getting Started\n\n## Installing and loading the required libraries\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\npacman::p_load(igraph, tidygraph, ggraph, \n               visNetwork, lubridate, clock,\n               tidyverse, graphlayouts, ggforce, skimr, tidytext, jsonlite)\n```\n:::\n\n\n\n\n## Loading the Data\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_data <- fromJSON(\"data/MC3_2023.json\")\n```\n:::\n\n\n::: panel-tabset\n\n### Links\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nmc3_edges <-\n  as_tibble(mc3_data$links) %>%\n  distinct() %>%\n  mutate(source =\n           as.character(source),\n         target = \n           as.character(target),\n         type = as.character(type)) %>%\n  group_by(source, target, type) %>%\n    summarise(weights=n()) %>%\n  filter(source!= target) %>%\n  ungroup()\n```\n:::\n\n\n### Nodes\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nmc3_nodes <- as_tibble(mc3_data$nodes) %>%\n  mutate(id = as.character(id), \n         type = as.character(type), \n         country = as.character(country), \n         product_services = as.character(product_services),\n  # Convert to character first to unlist, then revert to numeric form \n         revenue_omu = as.numeric(as.character(revenue_omu))) %>%\n  # Reorganize columns \n  select(id, country, type, revenue_omu, product_services)\n```\n:::\n\n \n:::\n\n\n::: {.cell}\n\n:::\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nid1 <- mc3_edges %>%\n  select(source) %>%\n  rename(id = source)\nid2 <- mc3_edges %>%\n  select(target) %>%\n  rename(id = target)\n\nmc3_nodes1 <- bind_rows(id1, id2) %>%\n  distinct() %>%\n  left_join(mc3_nodes, by = \"id\", unmatched = \"drop\")\n```\n:::\n\n::: {.cell}\n\n:::\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nmc3_graph <- tbl_graph(nodes = mc3_nodes1,\n                       edges = mc3_edges,\n                       directed = FALSE) %>%\n  mutate(betweenness_centrality = centrality_betweenness(),\n         closeness_centrality = centrality_closeness())\n```\n:::\n\n::: {.cell}\n\n:::\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nmc3_graph %>%\n  filter(betweenness_centrality >= 300000) %>%\nggraph(layout = \"fr\") +\n  geom_edge_link(aes(alpha=0.5)) +\n  geom_node_point(aes(\n    size = betweenness_centrality,\n    colors = \"lightblue\",\n    alpha=0.5)) +\n  scale_size_continuous(range=c(1,10)) +\n  theme_graph()\n```\n\n::: {.cell-output-display}\n![](In-class_Ex06b_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_graph_directed <- tbl_graph(nodes = mc3_nodes1,\n                       edges = mc3_edges,\n                       directed = TRUE) %>%\n  mutate(betweenness_centrality = centrality_betweenness(),\n         closeness_centrality = centrality_closeness())\n```\n:::\n",
    "supporting": [
      "In-class_Ex06b_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}